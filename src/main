import base64
import os
import json
import requests


def get_access_token(client_id: str, client_secret: str):
    '''
    param: client_id
    param: client_secret
    '''
    auth_url = "https://accounts.spotify.com/api/token"
    auth_header = {}
    auth_data = {}

    message = f"{client_id}:{client_secret}"
    base64_message = base64.b64encode(message.encode("ascii")).decode("ascii")

    auth_header["Authorization"] = "Basic " + base64_message
    auth_data["grant_type"] = "client_credentials"
    response = requests.post(auth_url, headers=auth_header, data=auth_data, timeout=2).json()

    return response["access_token"]


def get_playlist_tracks(token, playlist_id: str):
    '''
    param: token
    param: playlist_id
    '''
    playlist_end_point = f"https://api.spotify.com/v1/playlists/{playlist_id}"

    get_header = {
        "Authorization": "Bearer " + token
    }

    return requests.get(playlist_end_point, headers=get_header, timeout=2).json()
 

playlist_id = (
    "2G7UUHsjDigOjcEBPgE5NI?si=0953a39f2c5e4b78"
)
access_token = get_access_token(
    client_id=os.getenv("CLIENT_ID"),
    client_secret=os.getenv("CLIENT_SECRET"),
)

playlist = get_playlist_tracks(token=access_token, playlist_id=playlist_id)

print(json.dumps(playlist))
